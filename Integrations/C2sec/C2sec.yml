commonfields:
  id: C2sec irisk
  version: -1
name: C2sec irisk
display: C2sec irisk
category: Data Enrichment & Threat Intelligence
description: Understand Your Cyber Exposure as Easy as a Google Search
configuration:
- display: API URL (e.g https://api.c2sec.com/api)
  name: endpointURL
  defaultvalue: ""
  type: 0
  required: true
- display: API Key
  name: apikey
  defaultvalue: ""
  type: 4
  required: true
- display: Default Domain Name
  name: domainName
  defaultvalue: ""
  type: 0
  required: true
- display: Trust any certificate (unsecure)
  name: unsecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy
  name: proxy
  required: false
  type: 8
script:
  script: '-'
  type: python
  commands:
  - name: irisk-add-company
    arguments:
    - name: domain
      description: Domain to be added into the portfolio (if empty default domain will be used)
    - name: newscan
      required: true
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Flag to indicate whether we would always start a new scan for the
        domain
      defaultValue: "true"
    outputs:
    - contextPath: C2Sec.Company.result
      description: result status of adding the new company.
    description: Add a company into portfolio
  - name: irisk-query-workitem
    arguments:
    - name: id
      required: true
      description: Domain workitemid whose status to be checked
    outputs:
    - contextPath: C2sec.Scan.workitemid
      description: The ID of the current scan.
      type: number
    - contextPath: C2sec.Scan.domain
      description: The scanned domain name.
      type: string
    - contextPath: C2sec.Scan.completeTime
      description: The time in which the scan was completed.
      type: date
    - contextPath: C2sec.Scan.creationTime
      description: The time in which the scan was initiated.
      type: date
    - contextPath: C2sec.Scan.status
      description: The status of the current scan.(processing/completed)
      type: number
    description: Query workitem status
  - name: irisk-rescan-company
    arguments:
    - name: domain
      description: Domain to be rescaned (if empty default domain will be used)
    outputs:
    - contextPath: C2sec.Scan.workitemid
      description: Scan ID
      type: number
    - contextPath: C2sec.Scan.result
      description: The scan result status.
      type: string
    description: Initiate a rescan for companies inside portfolio
  - name: irisk-query-issues
    arguments:
    - name: domain
      description: Domain to be queried (if empty default domain it will be used)
    outputs:
    - contextPath: C2sec.Issue.ID
      description: The ID of the issue.
      type: string
    - contextPath: C2sec.Issue.Asset
      description: Asset associated with the issues. Example, ip addresses, website URLs, etc.
      type: string
    - contextPath: C2sec.Issue.Component
      description: The component used in the issue.
      type: string
    - contextPath: C2sec.Issue.ComponentDisplay
      description: The display name of the component being used.
      type: string
    - contextPath: C2sec.Issue.Details
      description: The details for the issue.
      type: string
    - contextPath: C2sec.Issue.Issue
      description: The name of the issue.
      type: string
    - contextPath: C2sec.Issue.Severity
      description: The severity of the issue.
      type: string
    description: Query identified issues for companies in the portfolio
  - name: irisk-query-component
    arguments:
    - name: domain
      required: true
      description: Domain to be queried (if empty default domain will be used)
    - name: component
      required: true
      auto: PREDEFINED
      predefined:
      - credential
      - network
      - application
      description: Component to be queried
    outputs:
    - contextPath: C2sec.Query.component
      description: Component Name
      type: string
    - contextPath: C2sec.Query.result
      description: Query Status
      type: string
    - contextPath: C2sec.Query.Domain
      description: The domain name being queried.
      type: string
    - contextPath: C2sec.Query.data.component
      description: The component being used for the query.
      type: string
    - contextPath: C2sec.Query.data.appdetail
      description: Details about the app being checked.
      type: string
    - contextPath: C2sec.Query.data.info
      description: Info regarding the data being processed.
      type: string
    - contextPath: C2sec.Query.data.website
      description: Website address being processed.
      type: string
    description: Query Data for specific component for companies in the portfolio
  runonce: false
