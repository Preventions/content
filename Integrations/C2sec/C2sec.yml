commonfields:
  id: C2sec
  version: -1
name: C2sec
display: C2sec
category: Data Enrichment & Threat Intelligence
description: Understand Your Cyber Exposure as Easy as a Google Search
configuration:
- display: API URL (e.g https://api.c2sec.com/api)
  name: endpointURL
  defaultvalue: ""
  type: 0
  required: true
- display: API Key
  name: apikey
  defaultvalue: ""
  type: 4
  required: true
- display: Default Domain Name
  name: domainName
  defaultvalue: ""
  type: 0
  required: true
- display: Trust any certificate (unsecure)
  name: unsecure
  defaultvalue: ""
  type: 8
  required: false
script:
  script: '-'
  type: python
  commands:
  - name: irisk-add-company
    arguments:
    - name: domain
      description: Domain to be added into the portfolio (if empty default domain
        it will be used)
    - name: newscan
      required: true
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Flag to indicate whether we would always start a new scan for the
        domain
      defaultValue: "true"
    outputs:
    - contextPath: C2Sec.Company.result
      description: Add Company Result
    description: Add a company into portfolio
  - name: irisk-query-workitem
    arguments:
    - name: id
      required: true
      description: Domain whose status to be checked
    outputs:
    - contextPath: C2sec.Scan.workitemid
      description: The ID of the current scan.
      type: number
    - contextPath: C2sec.Scan.domain
      description: The scanned domain name.
      type: string
    - contextPath: C2sec.Scan.completeTime
      description: The time in which the scan was completed.
      type: date
    - contextPath: C2sec.Scan.creationTime
      description: The time in which the scan was initiated.
      type: date
    - contextPath: C2sec.Scan.status
      description: The status of the current scan.(processing/completed)
      type: number
    description: Query workitem status
  - name: irisk-rescan-company
    arguments:
    - name: domain
      description: Domain to be rescaned (if empty default domain it will be used)
    outputs:
    - contextPath: C2sec.Scan.workitemid
      description: Scan ID
      type: number
    - contextPath: C2sec.Scan.result
      description: The scan result.
      type: string
    description: Initiate a rescan for companies inside portfolio
  - name: irisk-query-issues
    arguments:
    - name: domain
      description: Domain to be queried (if empty default domain it will be used)
    outputs:
    - contextPath: C2sec.Issue.ID
      description: The ID of the issue.
      type: string
    - contextPath: C2sec.Issue.asset
      description: The asset the issue is using.
      type: string
    - contextPath: C2sec.Issue.component
      description: The component used in the issue.
      type: string
    - contextPath: C2sec.Issue.componentDisplay
      description: The display name of the component being used.
      type: string
    - contextPath: C2sec.Issue.details
      description: The details for the issue.
      type: string
    - contextPath: C2sec.Issue.issue
      description: The name of the issue.
      type: string
    - contextPath: C2sec.Issue.severity
      description: The severity of the issue.
      type: string
    description: Query identified issues for companies in the portfolio
  - name: irisk-query-component
    arguments:
    - name: domain
      required: true
      description: Domain to be queried (if empty default domain it will be used)
    - name: component
      required: true
      auto: PREDEFINED
      predefined:
      - credential
      - network
      - application
      description: Component to be queried
    outputs:
    - contextPath: C2sec.Query.component
      description: Component Name
      type: string
    - contextPath: C2sec.Query.result
      description: Query Status
      type: string
    - contextPath: C2sec.Query.domain
      description: The domain name being queried.
      type: string
    - contextPath: C2sec.Query.data
      description: Query Result
    description: Query Data for specific component for companies in the portfolio
  runonce: false
