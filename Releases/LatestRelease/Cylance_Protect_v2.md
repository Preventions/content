Handle error messages gracefully and improve logging